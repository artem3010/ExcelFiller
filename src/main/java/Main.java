import org.apache.poi.common.usermodel.HyperlinkType;import org.apache.poi.ss.usermodel.*;import java.io.*;import java.util.Arrays;import java.util.List;import java.util.Scanner;public class Main {    private static Workbook workbook;    public static void main(String[] args) throws Exception {        workbook = WorkbookFactory.create(new File("C:\\Excel\\src\\main\\resources\\input.xls"));        Scanner scanner = new Scanner(System.in);        int numOfCels = scanner.nextInt();        scanner.nextLine();        System.out.println("Input files directory");        String path = scanner.nextLine();        Cell cell1, cell2;        for (int i = 0; i < numOfCels; i++) {            cell1 = workbook.getSheetAt(0).getRow(i).getCell(1);            cell2 = workbook.getSheetAt(0).getRow(i).getCell(0);            Main.addLink(cell1, cell2, path);        }        workbook.close();    }    private static List<File> getResourceFiles(String path) {        File dir = new File(path);        File[] arrFiles = dir.listFiles();        List<File> lst = Arrays.asList(arrFiles);        return lst;    }    private static void addLink(Cell cell1, Cell cell2, String path) throws IOException {        DataFormatter formatter = new DataFormatter();        CreationHelper createHelper = workbook.getCreationHelper();        Hyperlink link = createHelper.createHyperlink(HyperlinkType.FILE);        String cellValue = formatter.formatCellValue(cell1);        if (cellValue.contains("BS") || cellValue.contains("ะะก")){            //TODO: Add govno s pizdoi        }        String adress = matcher(getResourceFiles(path),cellValue);        if (!adress.equals("")){            link.setAddress(adress);            cell2.setHyperlink(link);            cell2.setCellStyle(Main.getStyle());        }        workbook.write(new FileOutputStream(path + "\\output.xls"));    }    private static String matcher(List<File> files, String id) throws IOException {        for (File f: files             ) {            String name = f.getName();            if (name.indexOf(id)!=-1){                return f.getCanonicalPath();            }        }        return "";    }    private static CellStyle getStyle() {        Font font = workbook.createFont();        font.setColor(IndexedColors.BLUE.getIndex());        font.setUnderline((byte) 1);        CellStyle style = workbook.createCellStyle();        style.setFont(font);        return style;    }}